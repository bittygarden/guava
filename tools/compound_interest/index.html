<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="description" content="å¤åˆ©è®¡ç®—å™¨-ç›´è§‚æ„Ÿå—å¤åˆ©çš„ç¥å¥‡åŠ›é‡ã€‚è¾“å…¥å¹´æ”¶ç›Šç‡ï¼Œä¸€é”®è®¡ç®—æŠ•èµ„ç¿»å€ã€ç¿»åå€ç”šè‡³ç¿»åƒå€æ‰€éœ€æ—¶é—´ï¼Œé€šè¿‡å¯è§†åŒ–æŠ˜çº¿å›¾ç›´è§‚å±•ç¤ºè´¢å¯Œå¢é•¿æ›²çº¿ï¼ŒåŠ©æ‚¨æ·±å…¥ç†è§£é•¿æœŸæŠ•èµ„çš„æ—¶é—´ä»·å€¼ã€‚">
    <title>å¤åˆ©è®¡ç®—å™¨-ç›´è§‚æ„Ÿå—å¤åˆ©çš„æ•ˆæœ</title>
    <link rel="icon" href="/favicon.ico" type="image/x-icon" />
    <!-- å¼•å…¥Chart.jsåº“ç”¨äºç»˜åˆ¶æŠ˜çº¿å›¾ -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/4.4.0/chart.umd.min.js"></script>
    <style>
        /* å…¨å±€æ ·å¼ */
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: #ffffff;
            margin: 0;
            padding: 0;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            /* æ¶ˆé™¤æ°´å¹³æ»šåŠ¨æ¡ */
            overflow-x: hidden;
        }

        /* å®¹å™¨æ ·å¼ */
        .container {
            background-image: linear-gradient(-225deg, #E3FDF5 0%, #FFE6FA 100%);
            padding: 20px;
            border-radius: 15px;
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.1);
            width: 100%;
            height: 100%;
            box-sizing: border-box;
            animation: fadeIn 0.5s ease-out;
        }

        /* æ ‡é¢˜æ ·å¼ */
        h1 {
            text-align: center;
            color: #333333;
            font-size: 28px;
            margin-bottom: 20px;
        }

        /* æ ‡ç­¾æ ·å¼ */
        label {
            display: block;
            margin-bottom: 8px;
            color: #666666;
            font-size: 16px;
        }

        /* è¾“å…¥æ¡†æ ·å¼ */
        input {
            width: 100%;
            padding: 12px;
            margin-bottom: 20px;
            border: 1px solid #94b76c;
            border-radius: 8px;
            box-sizing: border-box;
            font-size: 16px;
            transition: border-color 0.3s ease;
        }

        input:focus {
            border: 1px solid #57aa7f;
            outline: 2px solid #57aa7f;
        }
        
        /* é”™è¯¯çŠ¶æ€æ ·å¼ */
        input.error {
            border: 2px solid #ff6b6b;
            animation: shake 0.5s ease-in-out;
        }
        
        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-5px); }
            75% { transform: translateX(5px); }
        }

        /* æŒ‰é’®æ ·å¼ */
        button {
            width: 100%;
            padding: 12px;
            background-color: #94b76c;
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 16px;
            transition: background-color 0.3s ease;
            margin-bottom: 5px;
        }

        button:hover {
            background-color: #57aa7f;
        }

        /* è¡¨æ ¼æ ·å¼ */
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 30px;
        }

        th, td {
            border: 1px solid #e0e0e0;
            padding: 12px;
            text-align: center;
        }

        th {
            background-color: #f0f0f0;
            color: #333333;
        }

        tr:nth-child(even) {
            background-color: #f9f9f9;
        }

        /* ä¿¡æ¯æ¡†æ ·å¼ */
        .info-box {
            background-color: #f9f9f9;
            border: 1px solid #e0e0e0;
            border-radius: 8px;
            padding: 16px;
            margin-top: 20px;
            margin-bottom: 30px;
            color: #666666;
            font-size: 14px;
        }

        .info-box p {
            margin: 8px 0;
        }

        /* é«˜äº®æ ·å¼ */
        .highlight {
            background-color: #e0f7fa !important;
            font-weight: 600;
        }

        /* å°å±å¹•è®¾å¤‡æ ·å¼ */
        @media (max-width: 480px) {

            th, td {
                padding: 10px;
                font-size: 14px;
            }

            h1 {
                font-size: 24px;
            }

            label {
                font-size: 14px;
            }

            input, button {
                font-size: 14px;
            }
        }

        /* æ·¡å…¥åŠ¨ç”» */
        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(-20px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* è¿”å›é¦–é¡µæŒ‰é’® */
        .back-to-home {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background-color: #94b76c;
            color: white;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            text-decoration: none;
            font-size: 20px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.2);
            transition: background-color 0.3s ease;
        }

        .back-to-home:hover {
            background-color: #57aa7f;
        }
        
        .highlight {
            background: #fff7e6 !important;
            font-weight: 600;
        }
        
        .footer {
            text-align: center;
            padding: 30px;
            background: #fafafa;
            border-top: 1px solid #f0f0f0;
            color: #8c8c8c;
        }
        
        @media (max-width: 768px) {
            .content {
                padding: 20px;
            }
            
            .header h1 {
                font-size: 2em;
            }
            
            table {
                display: block;
                overflow-x: auto;
                white-space: nowrap;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>å¤åˆ©è®¡ç®—å™¨</h1>
        <label for="interestRate">å¹´æ”¶ç›Šç‡ (%)</label>
        <input type="number" id="interestRate" step="0.01" min="0.01" max="100" placeholder="è¯·è¾“å…¥å¹´æ”¶ç›Šç‡ï¼Œä¾‹å¦‚ï¼š8.50" required>
        <button onclick="calculateCompoundInterest()">å¼€å§‹è®¡ç®—</button>
        
        <div class="info-box">
            <p><strong>åˆå§‹é‡‘é¢ï¼š</strong>1 ä¸‡å…ƒ</p>
            <p><strong>è®¡ç®—æ–¹å¼ï¼š</strong>å¤åˆ©è®¡ç®—ã€æ”¶ç›Šå†æŠ•å…¥ã€‘</p>
            <p><strong>è®¡ç®—ç›®æ ‡ï¼š</strong>ç¿»å€ã€ç¿»ä¸¤å€ï¼Œç›´åˆ°ç¿»1000å€ï¼Œæ¯ä¸€æ¬¡ç¿»å€éœ€è¦çš„æ—¶é—´</p>
        </div>
        
        <!-- å›¾è¡¨å®¹å™¨ -->
        <div style="margin: 30px 0; padding: 20px; background: white; border-radius: 8px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); display: none; width: 100%; height: 580px; box-sizing: border-box;" id="chartContainer">
            <h3 style="margin-bottom: 20px; color: #333;">å¤åˆ©å¢é•¿è¶‹åŠ¿å›¾</h3>
            <div style="height: 500px; overflow: hidden;">
                <canvas id="compoundInterestChart" style="width: 100%; height: 500px;"></canvas>
            </div>
        </div>
        
        <table id="resultTable" style="display: none;">
            <thead>
                <tr>
                    <th>æ—¶é—´ï¼ˆå¹´/å¤©ï¼‰</th>
                    <th>å€æ•°</th>
                    <th>é‡‘é¢(ä¸‡å…ƒ)</th>
                </tr>
            </thead>
            <tbody id="resultBody">
            </tbody>
        </table>
    </div>
    
    <a href="../../index.html" class="back-to-home">ğŸ </a>
    
    <script>
        let chartInstance = null;
        
        function calculateCompoundInterest() {
            const principal = 10000; // åˆå§‹é‡‘é¢
            const interestRateInput = document.getElementById('interestRate');
            const interestRate = parseFloat(interestRateInput.value);
            
            // å…ˆç§»é™¤å¯èƒ½å­˜åœ¨çš„é”™è¯¯æ ·å¼
            interestRateInput.classList.remove('error');
            
            if (isNaN(interestRate) || interestRate <= 0 || interestRate > 100) {
                // æ·»åŠ é”™è¯¯æ ·å¼æ¥é«˜äº®è¾“å…¥æ¡†
                interestRateInput.classList.add('error');
                
                // 3ç§’åè‡ªåŠ¨ç§»é™¤é”™è¯¯æ ·å¼
                setTimeout(() => {
                    interestRateInput.classList.remove('error');
                }, 3000);
                
                return;
            }
            
            const dailyRate = interestRate / 100 / 365; // æ—¥æ”¶ç›Šç‡
            const targetMultiples = [];
            
            // ç”Ÿæˆç›®æ ‡å€æ•°ï¼š1å€åˆ°1000å€
            for (let i = 1; i <= 1000; i++) {
                targetMultiples.push(i);
            }
            
            let currentAmount = principal;
            let currentDay = 0;
            let results = [];
            let currentMultipleIndex = 0;
            
            // æ·»åŠ åˆå§‹é‡‘é¢ï¼ˆç¬¬0å¤©ï¼‰ä½œä¸ºè¡¨æ ¼çš„ç¬¬ä¸€è¡Œ
            results.push({
                day: 0,
                multiple: 1,
                amount: principal
            });
            
            // è®¡ç®—æ¯ä¸€å¤©çš„å¢é•¿ï¼Œç›´åˆ°è¾¾åˆ°1000å€
            // å°†å¤©æ•°ä¸Šé™ä»100000å¢åŠ åˆ°1000000ï¼Œä»¥é€‚åº”ä½æ”¶ç›Šç‡çš„æƒ…å†µ
            while (currentAmount < principal * 1000 && currentDay < 1000000) { // é˜²æ­¢æ— é™å¾ªç¯
                currentDay++;
                const previousAmount = currentAmount;
                currentAmount = currentAmount * (1 + dailyRate);
                
                // æ£€æŸ¥è¿™ä¸€å¤©æ˜¯å¦è·¨è¶Šäº†å¤šä¸ªç›®æ ‡å€æ•°
                let dayResults = [];
                while (currentMultipleIndex < targetMultiples.length && 
                       currentAmount >= principal * targetMultiples[currentMultipleIndex]) {
                    const targetMultiple = targetMultiples[currentMultipleIndex];
                    
                    // å¦‚æœæ˜¯ç¬¬ä¸€å¤©å°±è¾¾åˆ°çš„å€æ•°
                    if (previousAmount >= principal * targetMultiple) {
                        currentMultipleIndex++;
                        continue;
                    }
                    
                    // è®¡ç®—ç²¾ç¡®çš„å¤©æ•°ï¼ˆçº¿æ€§æ’å€¼ï¼‰
                    const exactDay = currentDay - 1 + 
                        (Math.log(targetMultiple) - Math.log(previousAmount / principal)) / 
                        (Math.log(currentAmount / principal) - Math.log(previousAmount / principal));
                    
                    dayResults.push({
                        multiple: targetMultiple,
                        amount: principal * targetMultiple,
                        exactDay: exactDay
                    });
                    
                    currentMultipleIndex++;
                }
                
                // å¦‚æœè¿™ä¸€å¤©æœ‰å¤šä¸ªå€æ•°è¾¾æ ‡ï¼Œè®°å½•æœ€å°å’Œæœ€å¤§çš„å€æ•°å’Œé‡‘é¢
                if (dayResults.length > 0) {
                    const minMultiple = dayResults[0].multiple;
                    const maxMultiple = dayResults[dayResults.length - 1].multiple;
                    const minAmount = dayResults[0].amount;
                    const maxAmount = dayResults[dayResults.length - 1].amount;
                    
                    results.push({
                        day: Math.ceil(dayResults[0].exactDay),
                        multiple: minMultiple === maxMultiple ? minMultiple : `${minMultiple}-${maxMultiple}`,
                        amount: minAmount === maxAmount ? minAmount : `${formatNumber(minAmount)}-${formatNumber(maxAmount)}`,
                        exactDay: dayResults[0].exactDay
                    });
                }
            }
            
            // æ£€æŸ¥æ˜¯å¦å› ä¸ºå¤©æ•°é™åˆ¶è€Œåœæ­¢è®¡ç®—
            if (currentDay >= 1000000) {
                // æ·»åŠ ä¸€ä¸ªæç¤ºè¡Œ
                results.push({
                    day: currentDay,
                    multiple: `è®¡ç®—æˆªæ­¢äº${currentDay}å¤©`,
                    amount: formatNumber(currentAmount)
                });
            }
            
            // æ˜¾ç¤ºç»“æœ
            displayResults(results);
        }
        
        function displayResults(results) {
            const resultBody = document.getElementById('resultBody');
            resultBody.innerHTML = '';
            
            // å‡†å¤‡å›¾è¡¨æ•°æ®
            const chartLabels = []; // ç”¨äºæ˜¾ç¤ºçš„æ ‡ç­¾
            const chartData = [];    // é‡‘é¢æ•°æ®
            const chartXValues = []; // å®é™…çš„å¹´æ•°å€¼
            
            results.forEach((result, index) => {
                const row = document.createElement('tr');
                
                // è®¡ç®—å¹´æ•°ï¼ˆå¤©æ•°é™¤ä»¥365ï¼Œä¿ç•™ä¸¤ä½å°æ•°ï¼‰
                const years = (result.day / 365).toFixed(2);
                const displayDay = `${years}å¹´ï¼ˆ${result.day}å¤©ï¼‰`;
                
                row.innerHTML = `
                    <td>${displayDay}</td>
                    <td>${result.multiple}x</td>
                    <td>${typeof result.amount === 'number' ? formatNumber(result.amount) : result.amount}</td>
                `;
                
                resultBody.appendChild(row);
                
                // æ”¶é›†å›¾è¡¨æ•°æ®ï¼ˆåªæ”¶é›†æ•°å€¼ç±»å‹çš„é‡‘é¢æ•°æ®ï¼‰
                if (typeof result.amount === 'number') {
                    chartLabels.push(years + 'å¹´');
                    chartData.push(result.amount / 10000); // è½¬æ¢ä¸ºä¸‡å…ƒ
                    chartXValues.push(parseFloat(years)); // ä¿å­˜å®é™…çš„å¹´æ•°å€¼
                }
            });
            
            // æ˜¾ç¤ºå›¾è¡¨
            renderChart(chartLabels, chartData, chartXValues);
            document.getElementById('chartContainer').style.display = 'block';
            
            // æ»šåŠ¨åˆ°æŠ˜çº¿å›¾åŒºåŸŸ
            setTimeout(() => {
                const chartContainer = document.getElementById('chartContainer');
                if (chartContainer) {
                    chartContainer.scrollIntoView({ 
                        behavior: 'smooth',
                        block: 'start'
                    });
                }
            }, 100); // å°å»¶è¿Ÿç¡®ä¿DOMå·²æ›´æ–°
            
            document.getElementById('resultTable').style.display = 'table';
            
            // æ»šåŠ¨åˆ°ç»“æœåŒºåŸŸ
            document.getElementById('resultTable').scrollIntoView({ behavior: 'smooth' });
        }
        
        function renderChart(labels, data, xValues) {
            const ctx = document.getElementById('compoundInterestChart').getContext('2d');
            
            // è®¾ç½®canvasé«˜åº¦ä¸ºå›ºå®šçš„500pxï¼Œå¹¶ç¡®ä¿ä¸¥æ ¼é™åˆ¶
            const canvas = document.getElementById('compoundInterestChart');
            canvas.height = 500;
            canvas.style.height = '500px';
            canvas.style.maxHeight = '500px';
            canvas.style.display = 'block';
            
            // å¦‚æœå›¾è¡¨å®ä¾‹å·²å­˜åœ¨ï¼Œå…ˆé”€æ¯å®ƒ
            if (chartInstance) {
                chartInstance.destroy();
            }
            
            // åˆ›å»ºæ–°çš„å›¾è¡¨å®ä¾‹
            chartInstance = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: labels, // æ˜¾ç¤ºçš„æ ‡ç­¾
                    datasets: [{
                        label: 'é‡‘é¢ï¼ˆä¸‡å…ƒï¼‰',
                        data: data.map((value, index) => ({
                            x: xValues[index], // ä½¿ç”¨å®é™…çš„å¹´æ•°å€¼
                            y: value
                        })),
                        borderColor: '#94b76c',
                        backgroundColor: 'rgba(148, 183, 108, 0.1)',
                        borderWidth: 0.5,
                        fill: true,
                        tension: 0.2,
                        pointBackgroundColor: '#94b76c',
                            pointRadius: 1,
                            pointHoverRadius: 3
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            display: true,
                            position: 'top'
                        },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    return `é‡‘é¢: ${context.parsed.y.toFixed(2)}ä¸‡å…ƒ`;
                                },
                                title: function(tooltipItems) {
                                    // æŸ¥æ‰¾æœ€æ¥è¿‘çš„æ ‡ç­¾
                                    const xValue = tooltipItems[0].parsed.x;
                                    const closestIndex = xValues.reduce((closest, value, index) => 
                                        Math.abs(value - xValue) < Math.abs(xValues[closest] - xValue) ? index : closest, 0);
                                    return labels[closestIndex];
                                }
                            }
                        }
                    },
                    scales: {
                        x: {
                            type: 'linear', // ä½¿ç”¨çº¿æ€§è½´è€Œä¸æ˜¯ç±»åˆ«è½´
                            position: 'bottom',
                            title: {
                                display: true,
                                text: 'æ—¶é—´ï¼ˆå¹´ï¼‰'
                            },
                            grid: {
                                color: 'rgba(0, 0, 0, 0.05)'
                            },
                            ticks: {
                                // é™åˆ¶xè½´æ˜¾ç¤ºçš„æ ‡ç­¾æ•°é‡
                                maxTicksLimit: 10,
                                // è‡ªå®šä¹‰æ ‡ç­¾æ ¼å¼ï¼Œç¡®ä¿æ˜¾ç¤ºæ•´æ•°å¹´ä»½
                                callback: function(value) {
                                    return Math.round(value) + 'å¹´';
                                }
                            },
                            // è®¾ç½®xè½´èŒƒå›´
                            min: 0,
                            max: Math.max(...xValues) * 1.05 // ç¨å¾®æ‰©å¤§æœ€å¤§å€¼èŒƒå›´
                        },
                        y: {
                            beginAtZero: true,
                            title: {
                                display: true,
                                text: 'é‡‘é¢ï¼ˆä¸‡å…ƒï¼‰'
                            },
                            grid: {
                                color: 'rgba(0, 0, 0, 0.05)'
                            }
                        }
                    }
                }
            });
        }
        
        function formatNumber(num) {
            // å°†é‡‘é¢è½¬æ¢ä¸ºä¸‡å…ƒå¹¶æ·»åŠ å•ä½
            const amountInWanYuan = num / 10000;
            return new Intl.NumberFormat('zh-CN', {
                minimumFractionDigits: 2,
                maximumFractionDigits: 2
            }).format(amountInWanYuan) + 'ä¸‡å…ƒ';
        }
    </script>
</body>
</html>